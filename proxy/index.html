<!-- Copyright (c) Bloxcraft Studios 2025 -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bloxcraft UBG - Proxy</title>
<link rel="shortcut icon" type="image/png" href="/bloxcraft.png">
<meta name="description" content="The Unblocked Games Site For You To Play!">
<meta property="og:title" content="Bloxcraft UBG">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Bloxcraft UBG">
<meta name="theme-color" content="#5555FF"> 
<meta property="og:image" content="/homepage_banner.png" />
<meta property="og:description" content="The Unblocked Games Site You Can Play Everyday! It Also has Some Custom Games.">
<meta property="og:url" content="/" />
<style>
body {
  background-color: #5555FF;
  background-image: url('/homepage_background.png');
  background-repeat: no-repeat;
  background-position: center center;
  background-size: cover;
  background-attachment: fixed;
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 20px;
  color: #fff;
}
input#url {
  width: calc(60% - 8px);
  padding: 12px 20px;
  font-size: 16px;
  color: #333;
  border: 1px solid #ccc;
  border-radius: 8px;
  margin-right: 8px;
}
button {
  padding: 12px 20px;
  font-size: 16px;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin-right: 5px;
}
#go { background: linear-gradient(to bottom,#0077c2,#005f9c); }
#go:hover { background: linear-gradient(to bottom,#0088e0,#006eb5); }

#back { background: linear-gradient(to bottom,#5555ff,#3333cc); }
#back:hover { background: linear-gradient(to bottom,#6666ff,#4444cc); }

#forward { background: linear-gradient(to bottom,#00cc66,#009944); }
#forward:hover { background: linear-gradient(to bottom,#33dd77,#00aa55); }

#refresh { background: linear-gradient(to bottom,#ff9933,#cc6600); }
#refresh:hover { background: linear-gradient(to bottom,#ffaa55,#dd7700); }

#home { background: linear-gradient(to bottom,#5555ff,#3333cc); }
#home:hover { background: linear-gradient(to bottom,#6666ff,#4444cc); }

iframe#viewer {
  width: 100%;
  height: 80vh;
  border: 1px solid #ccc;
  margin-top: 12px;
}
footer {
  text-align: center;
  margin-top: 12px;
  font-size: 14px;
  color: #fff;
}
.navbar {
  background-color: #000;
  overflow: hidden;
  padding: 10px 20px;
}
.navbar a {
  float: left;
  color: #fff;
  text-align: center;
  padding: 10px 16px;
  text-decoration: none;
  font-size: 17px;
  transition: background 0.3s;
}
.navbar a:hover {
  background-color: #444;
}
</style>
</head>
<body>

<div class="navbar">
  <a href="/">Home</a>
  <a href="/games">Games</a>
  <a href="https://discord.gg/a65hcbpfct">Discord Server</a>
  <a href="https://docs.google.com/document/d/1UC3Eo6UoPCVlq1SiOFEj0HahQGPqqbadXSho5NKHbQU/edit?tab=t.0">Bloxcraft Unblocked Games List</a>
</div>

<button id="home">⌂</button>
<button id="back">⬅</button>
<button id="forward">➡</button>
<button id="refresh">⟳</button>
<input id="url" placeholder="bloxcraft://newtab" />
<button id="go">Visit ➤</button>

<iframe id="viewer"></iframe>

<script>
const WORKER_URLS = [
  'https://school-static.sweet-dawn-d933.workers.dev/',
  'https://school-static.bs-bloxcraft.workers.dev/',
  'https://school-static.bs-minecraft-pe.workers.dev/'
];

const iframe = document.getElementById('viewer');
const historyStack = [];
const forwardStack = [];

async function tryWorkers(url) {
  for (const worker of WORKER_URLS) {
    try {
      const test = await fetch(`${worker}?url=${encodeURIComponent(url)}`, { method: 'HEAD' });
      if (test.ok) return worker;
    } catch(e) {}
  }
  return null;
}

async function loadUrl(url, pushHistory = true) {
  if (!url) return;

  let displayUrl = url; 
  if (!url.startsWith('http')) {
    if (url.startsWith('bloxcraft://')) {
      if (url === 'bloxcraft://newtab') {
        url = 'https://bloxcraft-ubg.pages.dev/proxy/new-tab/';
        displayUrl = 'bloxcraft://newtab';
      }
    } else {
      url = `https://www.bing.com/search?q=${encodeURIComponent(url)}`;
      displayUrl = url;
    }
  }

  const worker = await tryWorkers(url);
  if (!worker) { alert('ERROR: All proxy stations are blocked or page does not exist.'); return; }

  iframe.src = `${worker}?url=${encodeURIComponent(url)}`;
  if (pushHistory) {
    historyStack.push({ url, worker, displayUrl });
    forwardStack.length = 0;
  }
  document.getElementById('url').value = displayUrl;
}

document.getElementById('go').addEventListener('click', async () => {
  const value = document.getElementById('url').value.trim();
  if (value) loadUrl(value);
});

document.getElementById('back').addEventListener('click', () => {
  if (historyStack.length <= 1) return;
  const current = historyStack.pop();
  forwardStack.push(current);
  const previous = historyStack[historyStack.length - 1];
  iframe.src = `${previous.worker}?url=${encodeURIComponent(previous.url)}`;
  document.getElementById('url').value = previous.displayUrl;
});

document.getElementById('forward').addEventListener('click', () => {
  if (!forwardStack.length) return;
  const next = forwardStack.pop();
  iframe.src = `${next.worker}?url=${encodeURIComponent(next.url)}`;
  historyStack.push(next);
  document.getElementById('url').value = next.displayUrl;
});

document.getElementById('refresh').addEventListener('click', () => {
  if (!historyStack.length) return;
  const current = historyStack[historyStack.length - 1];
  iframe.src = `${current.worker}?url=${encodeURIComponent(current.url)}`;
});

document.getElementById('home').addEventListener('click', () => {
  loadUrl('bloxcraft://newtab');
});

window.addEventListener('load', () => loadUrl('bloxcraft://newtab', true));
</script>

<footer>
  <p>Copyright (c) Bloxcraft Studios 2025</p>
</footer>
</body>
</html>

